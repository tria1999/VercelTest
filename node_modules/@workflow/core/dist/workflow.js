import { runInContext } from 'node:vm';
import { ERROR_SLUGS, WorkflowRuntimeError } from '@workflow/errors';
import { withResolvers } from '@workflow/utils';
import { getPort } from '@workflow/utils/get-port';
import * as nanoid from 'nanoid';
import { monotonicFactory } from 'ulid';
import { EventConsumerResult, EventsConsumer } from './events-consumer.js';
import { ENOTSUP } from './global.js';
import { parseWorkflowName } from './parse-name.js';
import { dehydrateWorkflowReturnValue, hydrateWorkflowArguments, } from './serialization.js';
import { createUseStep } from './step.js';
import { BODY_INIT_SYMBOL, STABLE_ULID, WORKFLOW_CREATE_HOOK, WORKFLOW_GET_STREAM_ID, WORKFLOW_SLEEP, WORKFLOW_USE_STEP, } from './symbols.js';
import * as Attribute from './telemetry/semantic-conventions.js';
import { trace } from './telemetry.js';
import { getWorkflowRunStreamId } from './util.js';
import { createContext } from './vm/index.js';
import { WORKFLOW_CONTEXT_SYMBOL } from './workflow/get-workflow-metadata.js';
import { createCreateHook } from './workflow/hook.js';
import { createSleep } from './workflow/sleep.js';
export async function runWorkflow(workflowCode, workflowRun, events) {
    return trace(`WORKFLOW.run ${workflowRun.workflowName}`, async (span) => {
        span?.setAttributes({
            ...Attribute.WorkflowName(workflowRun.workflowName),
            ...Attribute.WorkflowRunId(workflowRun.runId),
            ...Attribute.WorkflowRunStatus(workflowRun.status),
            ...Attribute.WorkflowEventsCount(events.length),
        });
        const startedAt = workflowRun.startedAt;
        if (!startedAt) {
            throw new Error(`Workflow run "${workflowRun.runId}" has no "startedAt" timestamp (should not happen)`);
        }
        // Get the port before creating VM context to avoid async operations
        // affecting the deterministic timestamp
        const port = await getPort();
        const { context, globalThis: vmGlobalThis, updateTimestamp, } = createContext({
            seed: workflowRun.runId,
            fixedTimestamp: +startedAt,
        });
        const workflowDiscontinuation = withResolvers();
        const ulid = monotonicFactory(() => vmGlobalThis.Math.random());
        const generateNanoid = nanoid.customRandom(nanoid.urlAlphabet, 21, (size) => new Uint8Array(size).map(() => 256 * vmGlobalThis.Math.random()));
        const workflowContext = {
            globalThis: vmGlobalThis,
            onWorkflowError: workflowDiscontinuation.reject,
            eventsConsumer: new EventsConsumer(events),
            generateUlid: () => ulid(+startedAt),
            generateNanoid,
            invocationsQueue: new Map(),
        };
        // Subscribe to the events log to update the timestamp in the vm context
        workflowContext.eventsConsumer.subscribe((event) => {
            const createdAt = event?.createdAt;
            if (createdAt) {
                updateTimestamp(+createdAt);
            }
            // Never consume events - this is only a passive subscriber
            return EventConsumerResult.NotConsumed;
        });
        const useStep = createUseStep(workflowContext);
        const createHook = createCreateHook(workflowContext);
        const sleep = createSleep(workflowContext);
        // @ts-expect-error - `@types/node` says symbol is not valid, but it does work
        vmGlobalThis[WORKFLOW_USE_STEP] = useStep;
        // @ts-expect-error - `@types/node` says symbol is not valid, but it does work
        vmGlobalThis[WORKFLOW_CREATE_HOOK] = createHook;
        // @ts-expect-error - `@types/node` says symbol is not valid, but it does work
        vmGlobalThis[WORKFLOW_SLEEP] = sleep;
        // @ts-expect-error - `@types/node` says symbol is not valid, but it does work
        vmGlobalThis[WORKFLOW_GET_STREAM_ID] = (namespace) => getWorkflowRunStreamId(workflowRun.runId, namespace);
        // TODO: there should be a getUrl method on the world interface itself. This
        // solution only works for vercel + local worlds.
        const url = process.env.VERCEL_URL
            ? `https://${process.env.VERCEL_URL}`
            : `http://localhost:${port ?? 3000}`;
        // For the workflow VM, we store the context in a symbol on the `globalThis` object
        const ctx = {
            workflowRunId: workflowRun.runId,
            workflowStartedAt: new vmGlobalThis.Date(+startedAt),
            url,
        };
        // @ts-expect-error - `@types/node` says symbol is not valid, but it does work
        vmGlobalThis[WORKFLOW_CONTEXT_SYMBOL] = ctx;
        // @ts-expect-error - `@types/node` says symbol is not valid, but it does work
        vmGlobalThis[STABLE_ULID] = ulid;
        // NOTE: Will have a config override to use the custom fetch step.
        //       For now `fetch` must be explicitly imported from `workflow`.
        vmGlobalThis.fetch = () => {
            throw new vmGlobalThis.Error(`Global "fetch" is unavailable in workflow functions. Use the "fetch" step function from "workflow" to make HTTP requests.\n\nLearn more: https://useworkflow.dev/err/${ERROR_SLUGS.FETCH_IN_WORKFLOW_FUNCTION}`);
        };
        // Override timeout/interval functions to throw helpful errors
        // These are not supported in workflow functions because they rely on
        // asynchronous scheduling which breaks deterministic replay
        const timeoutErrorMessage = 'Timeout functions like "setTimeout" and "setInterval" are not supported in workflow functions. Use the "sleep" function from "workflow" for time-based delays.';
        vmGlobalThis.setTimeout = () => {
            throw new WorkflowRuntimeError(timeoutErrorMessage, {
                slug: ERROR_SLUGS.TIMEOUT_FUNCTIONS_IN_WORKFLOW,
            });
        };
        vmGlobalThis.setInterval = () => {
            throw new WorkflowRuntimeError(timeoutErrorMessage, {
                slug: ERROR_SLUGS.TIMEOUT_FUNCTIONS_IN_WORKFLOW,
            });
        };
        vmGlobalThis.clearTimeout = () => {
            throw new WorkflowRuntimeError(timeoutErrorMessage, {
                slug: ERROR_SLUGS.TIMEOUT_FUNCTIONS_IN_WORKFLOW,
            });
        };
        vmGlobalThis.clearInterval = () => {
            throw new WorkflowRuntimeError(timeoutErrorMessage, {
                slug: ERROR_SLUGS.TIMEOUT_FUNCTIONS_IN_WORKFLOW,
            });
        };
        vmGlobalThis.setImmediate = () => {
            throw new WorkflowRuntimeError(timeoutErrorMessage, {
                slug: ERROR_SLUGS.TIMEOUT_FUNCTIONS_IN_WORKFLOW,
            });
        };
        vmGlobalThis.clearImmediate = () => {
            throw new WorkflowRuntimeError(timeoutErrorMessage, {
                slug: ERROR_SLUGS.TIMEOUT_FUNCTIONS_IN_WORKFLOW,
            });
        };
        // `Request` and `Response` are special built-in classes that invoke steps
        // for the `json()`, `text()` and `arrayBuffer()` instance methods
        class Request {
            cache;
            credentials;
            destination;
            headers;
            integrity;
            method;
            mode;
            redirect;
            referrer;
            referrerPolicy;
            url;
            keepalive;
            signal;
            duplex;
            body;
            constructor(input, init) {
                // Handle URL input
                if (typeof input === 'string' || input instanceof vmGlobalThis.URL) {
                    const urlString = String(input);
                    // Validate URL format
                    try {
                        new vmGlobalThis.URL(urlString);
                        this.url = urlString;
                    }
                    catch (cause) {
                        throw new TypeError(`Failed to parse URL from ${urlString}`, {
                            cause,
                        });
                    }
                }
                else {
                    // Input is a Request object - clone its properties
                    this.url = input.url;
                    if (!init) {
                        this.method = input.method;
                        this.headers = new vmGlobalThis.Headers(input.headers);
                        this.body = input.body;
                        this.mode = input.mode;
                        this.credentials = input.credentials;
                        this.cache = input.cache;
                        this.redirect = input.redirect;
                        this.referrer = input.referrer;
                        this.referrerPolicy = input.referrerPolicy;
                        this.integrity = input.integrity;
                        this.keepalive = input.keepalive;
                        this.signal = input.signal;
                        this.duplex = input.duplex;
                        this.destination = input.destination;
                        return;
                    }
                    // If init is provided, merge: use source properties, then override with init
                    // Copy all properties from the source Request first
                    this.method = input.method;
                    this.headers = new vmGlobalThis.Headers(input.headers);
                    this.body = input.body;
                    this.mode = input.mode;
                    this.credentials = input.credentials;
                    this.cache = input.cache;
                    this.redirect = input.redirect;
                    this.referrer = input.referrer;
                    this.referrerPolicy = input.referrerPolicy;
                    this.integrity = input.integrity;
                    this.keepalive = input.keepalive;
                    this.signal = input.signal;
                    this.duplex = input.duplex;
                    this.destination = input.destination;
                }
                // Override with init options if provided
                // Set method
                if (init?.method) {
                    this.method = init.method.toUpperCase();
                }
                else if (typeof this.method !== 'string') {
                    // Fallback to default for string input case
                    this.method = 'GET';
                }
                // Set headers
                if (init?.headers) {
                    this.headers = new vmGlobalThis.Headers(init.headers);
                }
                else if (typeof input === 'string' ||
                    input instanceof vmGlobalThis.URL) {
                    // For string/URL input, create empty headers
                    this.headers = new vmGlobalThis.Headers();
                }
                // Set other properties with init values or defaults
                if (init?.mode !== undefined) {
                    this.mode = init.mode;
                }
                else if (typeof this.mode !== 'string') {
                    this.mode = 'cors';
                }
                if (init?.credentials !== undefined) {
                    this.credentials = init.credentials;
                }
                else if (typeof this.credentials !== 'string') {
                    this.credentials = 'same-origin';
                }
                // `any` cast here because @types/node v22 does not yet have `cache`
                if (init?.cache !== undefined) {
                    this.cache = init.cache;
                }
                else if (typeof this.cache !== 'string') {
                    this.cache = 'default';
                }
                if (init?.redirect !== undefined) {
                    this.redirect = init.redirect;
                }
                else if (typeof this.redirect !== 'string') {
                    this.redirect = 'follow';
                }
                if (init?.referrer !== undefined) {
                    this.referrer = init.referrer;
                }
                else if (typeof this.referrer !== 'string') {
                    this.referrer = 'about:client';
                }
                if (init?.referrerPolicy !== undefined) {
                    this.referrerPolicy = init.referrerPolicy;
                }
                else if (typeof this.referrerPolicy !== 'string') {
                    this.referrerPolicy = '';
                }
                if (init?.integrity !== undefined) {
                    this.integrity = init.integrity;
                }
                else if (typeof this.integrity !== 'string') {
                    this.integrity = '';
                }
                if (init?.keepalive !== undefined) {
                    this.keepalive = init.keepalive;
                }
                else if (typeof this.keepalive !== 'boolean') {
                    this.keepalive = false;
                }
                if (init?.signal !== undefined) {
                    // @ts-expect-error - AbortSignal stub
                    this.signal = init.signal;
                }
                else if (!this.signal) {
                    // @ts-expect-error - AbortSignal stub
                    this.signal = { aborted: false };
                }
                if (!this.duplex) {
                    this.duplex = 'half';
                }
                if (!this.destination) {
                    this.destination = 'document';
                }
                const body = init?.body;
                // Validate that GET/HEAD methods don't have a body
                if (body !== null &&
                    body !== undefined &&
                    (this.method === 'GET' || this.method === 'HEAD')) {
                    throw new TypeError(`Request with GET/HEAD method cannot have body.`);
                }
                // Store the original BodyInit for serialization
                if (body !== null && body !== undefined) {
                    // Create a "fake" ReadableStream that stores the original body
                    // This avoids doing async work during workflow replay
                    this.body = Object.create(vmGlobalThis.ReadableStream.prototype, {
                        [BODY_INIT_SYMBOL]: {
                            value: body,
                            writable: false,
                        },
                    });
                }
                else {
                    this.body = null;
                }
            }
            clone() {
                ENOTSUP();
            }
            get bodyUsed() {
                return false;
            }
            // TODO: implement these
            blob;
            formData;
            async arrayBuffer() {
                return resArrayBuffer(this);
            }
            async bytes() {
                return new Uint8Array(await resArrayBuffer(this));
            }
            async json() {
                return resJson(this);
            }
            async text() {
                return resText(this);
            }
        }
        vmGlobalThis.Request = Request;
        const resJson = useStep('__builtin_response_json');
        const resText = useStep('__builtin_response_text');
        const resArrayBuffer = useStep('__builtin_response_array_buffer');
        class Response {
            type;
            url;
            status;
            statusText;
            body;
            headers;
            redirected;
            constructor(body, init) {
                this.status = init?.status ?? 200;
                this.statusText = init?.statusText ?? '';
                this.headers = new vmGlobalThis.Headers(init?.headers);
                this.type = 'default';
                this.url = '';
                this.redirected = false;
                // Validate that null-body status codes don't have a body
                // Per HTTP spec: 204 (No Content), 205 (Reset Content), and 304 (Not Modified)
                if (body !== null &&
                    body !== undefined &&
                    (this.status === 204 || this.status === 205 || this.status === 304)) {
                    throw new TypeError(`Response constructor: Invalid response status code ${this.status}`);
                }
                // Store the original BodyInit for serialization
                if (body !== null && body !== undefined) {
                    // Create a "fake" ReadableStream that stores the original body
                    // This avoids doing async work during workflow replay
                    this.body = Object.create(vmGlobalThis.ReadableStream.prototype, {
                        [BODY_INIT_SYMBOL]: {
                            value: body,
                            writable: false,
                        },
                    });
                }
                else {
                    this.body = null;
                }
            }
            // TODO: implement these
            clone;
            blob;
            formData;
            get ok() {
                return this.status >= 200 && this.status < 300;
            }
            get bodyUsed() {
                return false;
            }
            async arrayBuffer() {
                return resArrayBuffer(this);
            }
            async bytes() {
                return new Uint8Array(await resArrayBuffer(this));
            }
            async json() {
                return resJson(this);
            }
            static json(data, init) {
                const body = JSON.stringify(data);
                const headers = new vmGlobalThis.Headers(init?.headers);
                if (!headers.has('content-type')) {
                    headers.set('content-type', 'application/json');
                }
                return new Response(body, { ...init, headers });
            }
            async text() {
                return resText(this);
            }
            static error() {
                ENOTSUP();
            }
            static redirect(url, status = 302) {
                // Validate status code - only specific redirect codes are allowed
                if (![301, 302, 303, 307, 308].includes(status)) {
                    throw new RangeError(`Invalid redirect status code: ${status}. Must be one of: 301, 302, 303, 307, 308`);
                }
                // Create response with Location header
                const headers = new vmGlobalThis.Headers();
                headers.set('Location', String(url));
                const response = Object.create(Response.prototype);
                response.status = status;
                response.statusText = '';
                response.headers = headers;
                response.body = null;
                response.type = 'default';
                response.url = '';
                response.redirected = false;
                return response;
            }
        }
        vmGlobalThis.Response = Response;
        class ReadableStream {
            constructor() {
                ENOTSUP();
            }
            get locked() {
                return false;
            }
            cancel() {
                ENOTSUP();
            }
            getReader() {
                ENOTSUP();
            }
            pipeThrough() {
                ENOTSUP();
            }
            pipeTo() {
                ENOTSUP();
            }
            tee() {
                ENOTSUP();
            }
            values() {
                ENOTSUP();
            }
            static from() {
                ENOTSUP();
            }
            [Symbol.asyncIterator]() {
                ENOTSUP();
            }
        }
        vmGlobalThis.ReadableStream = ReadableStream;
        class WritableStream {
            constructor() {
                ENOTSUP();
            }
            get locked() {
                return false;
            }
            abort() {
                ENOTSUP();
            }
            close() {
                ENOTSUP();
            }
            getWriter() {
                ENOTSUP();
            }
        }
        vmGlobalThis.WritableStream = WritableStream;
        class TransformStream {
            readable;
            writable;
            constructor() {
                ENOTSUP();
            }
        }
        vmGlobalThis.TransformStream = TransformStream;
        // Eventually we'll probably want to provide our own `console` object,
        // but for now we'll just expose the global one.
        vmGlobalThis.console = globalThis.console;
        // HACK: propagate symbol needed for AI gateway usage
        const SYMBOL_FOR_REQ_CONTEXT = Symbol.for('@vercel/request-context');
        // @ts-expect-error - `@types/node` says symbol is not valid, but it does work
        vmGlobalThis[SYMBOL_FOR_REQ_CONTEXT] = globalThis[SYMBOL_FOR_REQ_CONTEXT];
        // Get a reference to the user-defined workflow function.
        // The filename parameter ensures stack traces show a meaningful name
        // (e.g., "example/workflows/99_e2e.ts") instead of "evalmachine.<anonymous>".
        const parsedName = parseWorkflowName(workflowRun.workflowName);
        const filename = parsedName?.path || workflowRun.workflowName;
        const workflowFn = runInContext(`${workflowCode}; globalThis.__private_workflows?.get(${JSON.stringify(workflowRun.workflowName)})`, context, { filename });
        if (typeof workflowFn !== 'function') {
            throw new ReferenceError(`Workflow ${JSON.stringify(workflowRun.workflowName)} must be a function, but got "${typeof workflowFn}" instead`);
        }
        const args = hydrateWorkflowArguments(workflowRun.input, vmGlobalThis);
        span?.setAttributes({
            ...Attribute.WorkflowArgumentsCount(args.length),
        });
        // Invoke user workflow
        const result = await Promise.race([
            workflowFn(...args),
            workflowDiscontinuation.promise,
        ]);
        const dehydrated = dehydrateWorkflowReturnValue(result, vmGlobalThis);
        span?.setAttributes({
            ...Attribute.WorkflowResultType(typeof result),
        });
        return dehydrated;
    });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid29ya2Zsb3cuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvd29ya2Zsb3cudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLFNBQVMsQ0FBQztBQUN2QyxPQUFPLEVBQUUsV0FBVyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDckUsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQ2hELE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUVuRCxPQUFPLEtBQUssTUFBTSxNQUFNLFFBQVEsQ0FBQztBQUNqQyxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDeEMsT0FBTyxFQUFFLG1CQUFtQixFQUFFLGNBQWMsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQzNFLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxhQUFhLENBQUM7QUFDdEMsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFFcEQsT0FBTyxFQUNMLDRCQUE0QixFQUM1Qix3QkFBd0IsR0FDekIsTUFBTSxvQkFBb0IsQ0FBQztBQUM1QixPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBQzFDLE9BQU8sRUFDTCxnQkFBZ0IsRUFDaEIsV0FBVyxFQUNYLG9CQUFvQixFQUNwQixzQkFBc0IsRUFDdEIsY0FBYyxFQUNkLGlCQUFpQixHQUNsQixNQUFNLGNBQWMsQ0FBQztBQUN0QixPQUFPLEtBQUssU0FBUyxNQUFNLHFDQUFxQyxDQUFDO0FBQ2pFLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUN2QyxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFDbkQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUU5QyxPQUFPLEVBQUUsdUJBQXVCLEVB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